<div class="page-header">
    <h2>Thêm sản phẩm mới</h2>
    <a href="/products" class="btn btn-secondary">Quay lại</a>
</div>

<div class="form-container">
    {{#if error}}
    <div class="alert alert-danger">{{error}}</div>
    {{/if}}

    <form action="/products" method="POST">
        <div class="form-group">
            <label class="form-label">Mã sản phẩm (Tự động nếu để trống)</label>
            <input type="text" name="product_code" class="form-control" value="{{data.product_code}}"
                placeholder="Nhập mã hoặc để trống để tự tạo">
            <small>Nếu để trống, hệ thống sẽ tự tạo mã.</small>
        </div>

        <div class="form-group">
            <label class="form-label">Tên sản phẩm <span class="required">*</span></label>
            <input type="text" name="name" class="form-control" value="{{data.name}}" required>
        </div>

        <div class="row">
            <div class="col">
                <div class="form-group">
                    <label class="form-label">Giá bán mặc định <span class="required">*</span></label>
                    <input type="text" name="default_selling_price" class="form-control currency-input"
                        value="{{data.default_selling_price}}" required>
                </div>
            </div>
            <div class="col">
                <div class="form-group">
                    <label class="form-label">Đơn vị tính</label>
                    <input type="text" name="unit" class="form-control" value="{{data.unit}}"
                        placeholder="Cái, Chiếc, Bộ...">
                </div>
            </div>
        </div>

        <div class="form-group">
            <label class="form-label">Trạng thái</label>
            <select name="is_active" class="form-control">
                <option value="1" selected>Đang bán</option>
                <option value="0">Ngừng bán</option>
            </select>
        </div>

        <button type="submit" class="btn btn-primary">Lưu sản phẩm</button>
    </form>
</div>

<script>
    // Auto generate product code if empty
    document.querySelector('form').addEventListener('submit', function (e) {
        const codeInput = this.querySelector('input[name="product_code"]');
        if (!codeInput.value.trim()) {
            const timestamp = Date.now().toString().slice(-6);
            const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
            codeInput.value = 'SP' + timestamp + random;
        }
    });
</script>

<style>
    .form-container {
        background: white;
        padding: 30px;
        border-radius: 8px;
        max-width: 600px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .row {
        display: flex;
        gap: 20px;
    }

    .col {
        flex: 1;
    }

    .required {
        color: red;
    }

    .alert {
        padding: 10px;
        margin-bottom: 20px;
        border-radius: 4px;
        background-color: #fee2e2;
        color: #991b1b;
    }

    .btn-secondary {
        background-color: var(--secondary-color);
        color: white;
        text-decoration: none;
    }
</style>